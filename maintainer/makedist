#!/bin/sh

exec 2>&1 | tee makedist.log

DISTDIR=pyxbdist
cd /tmp
rm -rf ${DISTDIR}
svn export svn://scmhome/pyxb/trunk ${DISTDIR}
cd ${DISTDIR}
export PYXB_ROOT=`pwd`
cd doc
rm -rf html
rm -f pyxb
ln -s ../pyxb .
make apihtml html
rm -f pyxb
cd ..
for bundle in core wssplat opengis ; do
  pyxb/bundles/${bundle}/scripts/genbind || exit 1
done
./setup.py sdist
./setup.py test
cp -p dist/PyXB-*.tar.gz ~/pyxb/pre-release
